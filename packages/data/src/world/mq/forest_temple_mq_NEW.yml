"Forest Temple":
  dungeon: Forest
  exits:
    "Sacred Meadow": "true"
    "Forest Temple Entrance Room": "true"
"Forest Temple Wallmaster West":
  region: BUFFER_DELAYED
  exits:
    "VOID": "true"
"Forest Temple Wallmaster East":
  region: BUFFER_DELAYED
  exits:
    "VOID": "true"
"Forest Temple Entrance Room":
  dungeon: Forest
  exits: #Maybe make the upper branches where the event takes place its own region?
    "Forest Temple": "true"
    "Forest Temple Initial Hallway With Skultullas Facing Player": "true"
  events: #longshot_anywhere is for action shuffle and not being able to climb; redundant currently with can_hookshot
    FOREST_MQ_ENTRANCE_ROOM_CHEST_SWITCH: "longshot_anywhere || climb_anywhere || (has_nuts || can_hit_triggers_distance || can_hookshot || has_hover_boots || can_use_din || has_bomb_bag || can_use_mask_stone || (has_weapon && (has(MAGIC_UPGRADE) || has(SHARED_MAGIC_UPGRADE))))" #Many ways to deal with the Skulltula in the way.
  locations:
    "MQ Forest Temple First Room Chest": "event(FOREST_MQ_ENTRANCE_ROOM_CHEST_SWITCH)"
"Forest Temple Initial Hallway With Skultullas Facing Player":
  dungeon: Forest
  exits:
    "Forest Temple Entrance Room": "true"
    "Forest Temple Initial Hallway Navigation": "get_past_skultullas"
"Forest Temple Initial Hallway Navigation": #Even more ways to get past the skultulas. Region exists for enemy drops rando, and for ease of placing the door regions for door rando.
  dungeon: Forest
  exits:
    "Forest Temple Initial Hallway With Skultullas Facing Player": "get_past_skultullas"
    "Forest Temple Initial Hallway With Skultullas Not Facing Player": "get_past_skultullas"
"Forest Temple Initial Hallway With Skultullas Not Facing Player":
  dungeon: Forest
  exits:
    "Forest Temple Initial Hallway Navigation": "get_past_skultullas"
    "Forest Temple Main Lobby": "small_keys_forest(1)"
  locations:
    "MQ Forest Temple GS Entryway": "gs && (can_collect_distance || ((has_ranged_weapon || has_explosives) && climb_anywhere))" #Blast mask too? Need to have separate macros for close vs far-range explosives...



"Forest Temple Main Lobby":
  dungeon: Forest
  exits:
    "Forest Temple Initial Hallway With Skultullas Not Facing Player": "small_keys_forest(1)"
    "Forest Temple Antichamber Center": "event(FOREST_POE_4)"
    "Forest Temple Hallway Before Climbing Block Puzzle Room": "true"
    "Forest Temple West Garden Lower": "can_hit_triggers_distance"
    "Forest Temple East Garden Lower": "can_hit_triggers_distance"
    "Forest Temple Hallway Before Lower Section Of Stalfos Battle Room": "true"
  events:
    FOREST_POE_4: "event(FOREST_POE_1) && event(FOREST_POE_2) && event(FOREST_POE_3)"
  locations:
    "MQ Forest Temple Pot Main Room 1": "true"
    "MQ Forest Temple Pot Main Room 2": "true"
    "MQ Forest Temple Pot Main Room 3": "true"
    "MQ Forest Temple Pot Main Room 4": "true"
    "MQ Forest Temple Pot Main Room 5": "true"
    "MQ Forest Temple Pot Main Room 6": "true"




"Forest Temple Hallway Before Lower Section Of Stalfos Battle Room":
  dungeon: Forest
  exits:
    "Forest Temple Main Lobby": "true"
    "Forest Temple Lower Section of Stalfos Battle Room": "is_child || (is_adult && can_play_time)" #What about spawning here with SoT block and going backwards through it?
"Forest Temple Lower Section Of Stalfos Battle Room":
  dungeon: Forest
  exits:
    "Forest Temple Hallway Before Lower Section Of Stalfos Battle Room": "event(FOREST_MQ_UNDER_STALFOS_BATTLE_WOLFOS_CLEAR)"
    #Forest Temple Upper Section Of Stalfos Battle Room": "false" #Can't get up there when the Stalfos move the floor down.
  events:
    FOREST_MQ_UNDER_STALFOS_BATTLE_WOLFOS_CLEAR: "soul_wolfos && (has_weapon || can_use_slingshot || has_explosives || can_use_din || can_use_sticks)"
  locations:
    "MQ Forest Temple Wolfos Chest": "event(FOREST_MQ_UNDER_STALFOS_BATTLE_WOLFOS_CLEAR)"
    "MQ Forest Temple Pot Bow Room Lower 1": "true"
    "MQ Forest Temple Pot Bow Room Lower 2": "true"
"Forest Temple Hallway Before Climbing Block Puzzle Room":
  dungeon: Forest
  exits:
    "Forest Temple Main Lobby": "event(FOREST_MQ_HALLWAY_BEFORE_CLIMBING_BLOCKS_STALFOS_CLEAR)"
    "Forest Temple Climbing Block Puzzle Room Ground Floor": "event(FOREST_MQ_HALLWAY_BEFORE_CLIMBING_BLOCKS_STALFOS_CLEAR)"
  events:
    FOREST_MQ_HALLWAY_BEFORE_CLIMBING_BLOCKS_STALFOS_CLEAR: "soul_enemy(SOUL_ENEMY_STALFOS) && has_weapon"



"Forest Temple Climbing Block Puzzle Room Ground Floor":
  dungeon: Forest
  exits: #Separating floors now in preparation for action shuffle.
    "Forest Temple Hallway Before Climbing Block Puzzle Room": "true"
    "Forest Temple Climbing Block Puzzle Room Crystal Switch Ledge": #TODO: Trick to hookshot the target with the ice there as there is a small gap.
    "Forest Temple Climbing Block Puzzle Room First Block Floor": "true"
    "Forest Temple Climbing Block Puzzle Room First Block Floor Outer Ledge": "climb_anywhere || hookshot_anywhere"
  locations:
    "MQ Forest Temple GS Climb Room": "gs && can_damage_skull"


"Forest Temple Climbing Block Puzzle Room First Block Floor":
  dungeon: Forest
  exits:
    "Forest Temple Climbing Block Puzzle Room Ground Floor": "true"
    "Forest Temple Climbing Block Puzzle Room Second Block Floor": "(event(FOREST_MQ_FIRST_PUSH_BLOCK_PUZZLE_CLEAR) && is_adult) || hookshot_anywhere || climb_anywhere"
    "Forest Temple Climbing Block Puzzle Room First Block Floor Outer Ledge": "event(FOREST_MQ_FIRST_PUSH_BLOCK_PUZZLE_CLEAR)"
  events:
    FOREST_MQ_FIRST_PUSH_BLOCK_PUZZLE_CLEAR: "has_goron_bracelet"


"Forest Temple Climbing Block Puzzle Room First Block Floor Outer Ledge":
  dungeon: Forest
  exits:
    "Forest Temple Climbing Block Puzzle Room Ground Floor": "true"
    "Forest Temple Climbing Block Puzzle Room First Block Floor": "event(FOREST_MQ_FIRST_PUSH_BLOCK_PUZZLE_CLEAR)"
    "Forest Temple Climbing Block Puzzle Room Crystal Switch Ledge": "event(HHHHHHHH) && (has_hover_boots || SHORT OR LONG HOOK IDK YET)"



"Forest Temple Climbing Block Puzzle Room Second Block Floor":
  dungeon: Forest
  exits:
    "Forest Temple Climbing Block Puzzle Room Ground Floor": "true"
    "Forest Temple Climbing Block Puzzle Room First Block Floor": "true"
    "Forest Temple Climbing Block Puzzle Room First Block Floor Outer Ledge": "hookshot_anywhere || can_jump_slash"
  events:
    FOREST_MQ_CLIMBING_BLOCK_ROOM_TOP_FLOOR_CRYSTAL_SWITCH: "can_hit_triggers_distance" #Can hit it if you stand near the guard rails.
    FOREST_MQ_SECOND_PUSH_BLOCK_PUZZLE_CLEAR: "has_goron_bracelet && event(FOREST_MQ_FIRST_PUSH_BLOCK_PUZZLE_CLEAR)" #A little redundant, yes, but it is a separate flag.





    "Forest Temple West Wing": "has_weapon && soul_enemy(SOUL_ENEMY_STALFOS)"




"Forest Temple West Wing":
  dungeon: Forest
  exits:
    "Forest Temple Main": "has_weapon && soul_enemy(SOUL_ENEMY_STALFOS)"
    "Forest Temple Straightened Hallway": "small_keys_forest(3) && is_adult && has_goron_bracelet"
    "Forest Temple West Garden": "soul_floormaster && small_keys_forest(2) && is_adult && has_goron_bracelet" #This is sideways thinking, but you must have access to West Garden with 2 keys here because you cannot waste a third without access via another means.
    "Forest Temple Twisted Hallway": "small_keys_forest(3) && is_adult && has_goron_bracelet && event(FOREST_TWIST_SWITCH)"


"Forest Temple Straightened Hallway":
  dungeon: Forest
  exits:
    "Forest Temple Wallmaster West": "soul_wallmaster"
    "Forest Temple West Garden Ledge": "soul_floormaster"
  locations:
    "MQ Forest Temple Boss Key Chest": "true"
"Forest Temple West Garden Ledge":
  dungeon: Forest
  exits:
    "Forest Temple West Garden": "true"
    "Forest Temple West Wing": "event(FOREST_TWIST_SWITCH)"
  events:
    FOREST_TWIST_SWITCH: "true"
  locations:
    "MQ Forest Temple ReDead Chest": "soul_redead_gibdo"
    "MQ Forest Temple Heart Garden 1": "true"
    "MQ Forest Temple Heart Garden 2": "true"
    "MQ Forest Temple Heart Garden 3": "true"
"Forest Temple West Garden":
  dungeon: Forest
  exits:
    "Forest Temple Main": "true"
    "Forest Temple East Garden": "can_dive_big"
    "Forest Temple Garden Ledges": "has_fire_arrows"
  locations:
    "MQ Forest Temple GS West Garden": "gs"
"Forest Temple East Garden":
  dungeon: Forest
  exits:
    "Forest Temple Main": "true"
    "Forest Temple Garden Ledges": "can_longshot || (can_hookshot && (trick(OOT_FOREST_HOOK) || can_play_time))"
    "Forest Temple East Garden Ledge": "can_longshot"
  events:
    STICKS: "soul_deku_baba && (can_hookshot || can_hammer || can_boomerang || (has_nuts && has_weapon))"
    NUTS: "soul_deku_baba && (has_weapon || has_explosives || can_use_slingshot)"
  locations:
    "MQ Forest Temple Well Chest": "can_hit_triggers_distance"
    "MQ Forest Temple GS East Garden": "gs && can_collect_distance"
    "MQ Forest Temple GS Well": "gs && (can_hit_triggers_distance || (has_iron_boots && (can_hookshot || has_mask_blast)))"
    "MQ Forest Temple Heart Well 1": "can_hit_triggers_distance || has_iron_boots"
    "MQ Forest Temple Heart Well 2": "can_hit_triggers_distance || has_iron_boots"
    "MQ Forest Temple Heart Well 3": "can_hit_triggers_distance || has_iron_boots"
"Forest Temple Garden Ledges":
  dungeon: Forest
  exits:
    "Forest Temple West Garden": "can_use_bow || can_use_din"
    "Forest Temple East Garden": "true"
  locations:
    "MQ Forest Temple East Garden High Ledge Chest": "true"
    "MQ Forest Temple GS East Garden": "gs && can_play_time"
"Forest Temple East Garden Ledge":
  dungeon: Forest
  exits:
    "Forest Temple East Garden": "true"
    "Forest Temple Falling Ceiling": "can_play_time"
  locations:
    "MQ Forest Temple East Garden Ledge Chest": "true"
"Forest Temple Twisted Hallway":
  dungeon: Forest
  exits:
    "Forest Temple Wallmaster West": "soul_wallmaster"
    "Forest Temple Bow Region": "small_keys_forest(4)"
"Forest Temple Bow Region":
  dungeon: Forest
  exits:
    # FIXME: Simple implem as we don't have the 2nd hallway
    "Forest Temple Wallmaster East": "soul_wallmaster && soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon && small_keys_forest(5)"
    "Forest Temple Falling Ceiling": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon && small_keys_forest(5) && (can_use_bow || can_use_din)" #Only 5 keys is safe because, if you wasted a key in falling ceiling, you can go there otherwise.
  events:
    FOREST_POE_1: "can_use_bow"
    FOREST_POE_2: "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && can_use_bow"
  locations:
    "MQ Forest Temple Map Chest": "event(FOREST_POE_1)"
    "MQ Forest Temple Bow Chest": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon"
    "MQ Forest Temple Compass Chest": "event(FOREST_POE_2)"
    "MQ Forest Temple Pot Bow Room Upper 1": "true"
    "MQ Forest Temple Pot Bow Room Upper 2": "true"
    "MQ Forest Temple Pot Bow Room Upper 3": "true"
    "MQ Forest Temple Pot Bow Room Upper 4": "true"
    "MQ Forest Temple Pot Blue Poe 1": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos"
    "MQ Forest Temple Pot Blue Poe 2": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos"
    "MQ Forest Temple Pot Blue Poe 3": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos"
    "MQ Forest Temple Spinning Red Pool Room Small Crate 1": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon && small_keys_forest(5)"
    "MQ Forest Temple Spinning Red Pool Room Small Crate 2": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon && small_keys_forest(5)"
    "MQ Forest Temple Spinning Red Pool Room Small Crate 3": "soul_enemy(SOUL_ENEMY_STALFOS) && soul_wolfos && has_weapon && small_keys_forest(5)"
"Forest Temple Falling Ceiling":
  dungeon: Forest
  events:
    FOREST_POE_3: "small_keys_forest(6) && can_use_bow"
  locations:
    "MQ Forest Temple Falling Ceiling Chest": "true"
    "MQ Forest Temple East Garden Ledge Chest": "true"
    "MQ Forest Temple Pot Green Poe 1": "small_keys_forest(6)"
    "MQ Forest Temple Pot Green Poe 2": "small_keys_forest(6)"
"Forest Temple Antichamber":
  dungeon: Forest
  exits:
    "Forest Temple Boss": "boss_key(BOSS_KEY_FOREST)"
  locations:
    "MQ Forest Temple Antichamber": "true"
    "MQ Forest Temple Pot Antichamber 1": "true"
    "MQ Forest Temple Pot Antichamber 2": "true"
    "MQ Forest Temple Pot Antichamber 3": "true"
    "MQ Forest Temple Pot Antichamber 4": "true"
